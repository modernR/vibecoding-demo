<svg width="1000" height="800" viewBox="0 0 1000 800" xmlns="http://www.w3.org/2000/svg">
  <!-- 배경 -->
  <rect width="1000" height="800" fill="#f8fafc" stroke="none"/>
  
  <!-- 제목 -->
  <text x="500" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1e293b">
    2단계: AWS 백엔드 기반 TODO 요청 처리 시퀀스
  </text>
  
  <!-- 참여자들 -->
  <g id="participants">
    <!-- 사용자 -->
    <rect x="30" y="60" width="70" height="40" rx="5" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
    <text x="65" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#1e40af">
      사용자
    </text>
    
    <!-- UI 컴포넌트 -->
    <rect x="130" y="60" width="80" height="40" rx="5" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
    <text x="170" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">
      UI 컴포넌트
    </text>
    
    <!-- React Context -->
    <rect x="240" y="60" width="80" height="40" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
    <text x="280" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#92400e">
      Context
    </text>
    
    <!-- API 서비스 -->
    <rect x="350" y="60" width="80" height="40" rx="5" fill="#f0f9ff" stroke="#0284c7" stroke-width="2"/>
    <text x="390" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#0c4a6e">
      API 서비스
    </text>
    
    <!-- API Gateway -->
    <rect x="460" y="60" width="80" height="40" rx="5" fill="#fff7ed" stroke="#ea580c" stroke-width="2"/>
    <text x="500" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#c2410c">
      API Gateway
    </text>
    
    <!-- Lambda -->
    <rect x="570" y="60" width="80" height="40" rx="5" fill="#fef2f2" stroke="#dc2626" stroke-width="2"/>
    <text x="610" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#991b1b">
      Lambda
    </text>
    
    <!-- Cognito -->
    <rect x="680" y="60" width="80" height="40" rx="5" fill="#f3e8ff" stroke="#7c3aed" stroke-width="2"/>
    <text x="720" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#5b21b6">
      Cognito
    </text>
    
    <!-- DynamoDB -->
    <rect x="790" y="60" width="80" height="40" rx="5" fill="#e0f2fe" stroke="#0891b2" stroke-width="2"/>
    <text x="830" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#0e7490">
      DynamoDB
    </text>
  </g>
  
  <!-- 생명선 -->
  <g id="lifelines" stroke="#9ca3af" stroke-width="1" stroke-dasharray="3,3">
    <line x1="65" y1="100" x2="65" y2="750"/>
    <line x1="170" y1="100" x2="170" y2="750"/>
    <line x1="280" y1="100" x2="280" y2="750"/>
    <line x1="390" y1="100" x2="390" y2="750"/>
    <line x1="500" y1="100" x2="500" y2="750"/>
    <line x1="610" y1="100" x2="610" y2="750"/>
    <line x1="720" y1="100" x2="720" y2="750"/>
    <line x1="830" y1="100" x2="830" y2="750"/>
  </g>
  
  <!-- 인증 시퀀스 -->
  <g id="auth-sequence">
    <!-- 제목 -->
    <rect x="20" y="120" width="960" height="25" fill="#f3e8ff" stroke="#7c3aed" stroke-width="1"/>
    <text x="30" y="137" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#5b21b6">
      사용자 인증 처리
    </text>
    
    <!-- 1. 사용자 → UI -->
    <line x1="65" y1="160" x2="170" y2="160" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="90" y="155" font-family="Arial, sans-serif" font-size="9" fill="#374151">로그인 시도</text>
    
    <!-- 2. UI → Context -->
    <line x1="170" y1="180" x2="280" y2="180" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="200" y="175" font-family="Arial, sans-serif" font-size="9" fill="#374151">인증 요청</text>
    
    <!-- 3. Context → API -->
    <line x1="280" y1="200" x2="390" y2="200" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="310" y="195" font-family="Arial, sans-serif" font-size="9" fill="#374151">AWS Cognito 로그인</text>
    
    <!-- 4. API → Cognito -->
    <line x1="390" y1="220" x2="720" y2="220" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="520" y="215" font-family="Arial, sans-serif" font-size="9" fill="#374151">사용자 인증</text>
    
    <!-- 5. Cognito → API -->
    <line x1="720" y1="240" x2="390" y2="240" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <text x="520" y="235" font-family="Arial, sans-serif" font-size="9" fill="#374151">JWT 토큰 반환</text>
    
    <!-- 6-8. 응답 체인 -->
    <line x1="390" y1="260" x2="280" y2="260" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <line x1="280" y1="280" x2="170" y2="280" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <line x1="170" y1="300" x2="65" y2="300" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  </g>
  
  <!-- TODO 생성 시퀀스 -->
  <g id="create-todo-sequence">
    <!-- 제목 -->
    <rect x="20" y="340" width="960" height="25" fill="#eff6ff" stroke="#3b82f6" stroke-width="1"/>
    <text x="30" y="357" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1e40af">
      TODO 생성 요청 처리
    </text>
    
    <!-- 1. 사용자 → UI -->
    <line x1="65" y1="380" x2="170" y2="380" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="90" y="375" font-family="Arial, sans-serif" font-size="9" fill="#374151">TODO 입력 및 제출</text>
    
    <!-- 2. UI → Context -->
    <line x1="170" y1="400" x2="280" y2="400" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="200" y="395" font-family="Arial, sans-serif" font-size="9" fill="#374151">dispatch(ADD_TODO)</text>
    
    <!-- 3. Context → API -->
    <line x1="280" y1="420" x2="390" y2="420" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="300" y="415" font-family="Arial, sans-serif" font-size="8" fill="#374151">POST /api/todos (Auth 헤더)</text>
    
    <!-- 4. API → Gateway -->
    <line x1="390" y1="440" x2="500" y2="440" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="420" y="435" font-family="Arial, sans-serif" font-size="9" fill="#374151">HTTP 요청</text>
    
    <!-- 5. Gateway 내부 처리 -->
    <rect x="470" y="460" width="60" height="40" fill="#fff7ed" stroke="#ea580c" stroke-width="1"/>
    <text x="500" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#c2410c">CORS 검증</text>
    <text x="500" y="490" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#c2410c">JWT 검증</text>
    
    <!-- 6. Gateway → Cognito -->
    <line x1="500" y1="510" x2="720" y2="510" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="580" y="505" font-family="Arial, sans-serif" font-size="9" fill="#374151">JWT 토큰 검증</text>
    
    <!-- 7. Cognito → Gateway -->
    <line x1="720" y1="530" x2="500" y2="530" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <text x="580" y="525" font-family="Arial, sans-serif" font-size="9" fill="#374151">사용자 정보 반환</text>
    
    <!-- 8. Gateway → Lambda -->
    <line x1="500" y1="550" x2="610" y2="550" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="520" y="545" font-family="Arial, sans-serif" font-size="8" fill="#374151">Lambda 호출 (userId 포함)</text>
    
    <!-- 9. Lambda 내부 처리 -->
    <rect x="580" y="570" width="60" height="40" fill="#fef2f2" stroke="#dc2626" stroke-width="1"/>
    <text x="610" y="585" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#991b1b">데이터 검증</text>
    <text x="610" y="598" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#991b1b">TODO 생성</text>
    
    <!-- 10. Lambda → DynamoDB -->
    <line x1="610" y1="620" x2="830" y2="620" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="690" y="615" font-family="Arial, sans-serif" font-size="9" fill="#374151">PutItem 요청</text>
    
    <!-- 11. DynamoDB → Lambda -->
    <line x1="830" y1="640" x2="610" y2="640" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <text x="690" y="635" font-family="Arial, sans-serif" font-size="9" fill="#374151">저장 완료</text>
    
    <!-- 12-16. 응답 체인 -->
    <line x1="610" y1="660" x2="500" y2="660" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <text x="530" y="655" font-family="Arial, sans-serif" font-size="8" fill="#374151">201 Created</text>
    
    <line x1="500" y1="680" x2="390" y2="680" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <line x1="390" y1="700" x2="280" y2="700" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <line x1="280" y1="720" x2="170" y2="720" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
    <line x1="170" y1="740" x2="65" y2="740" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  </g>
  
  <!-- 화살표 마커 정의 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>
  
  <!-- 범례 -->
  <g id="legend">
    <rect x="50" y="765" width="900" height="30" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
    <text x="60" y="780" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#374151">
      범례:
    </text>
    <line x1="100" y1="775" x2="120" y2="775" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="125" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">요청</text>
    
    <line x1="160" y1="775" x2="180" y2="775" stroke="#374151" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)"/>
    <text x="185" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">응답</text>
    
    <rect x="220" y="772" width="20" height="10" fill="#fff7ed" stroke="#ea580c" stroke-width="1"/>
    <text x="245" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">내부 처리</text>
    
    <text x="300" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">• 인증: 보라색</text>
    <text x="400" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">• API: 주황색</text>
    <text x="500" y="779" font-family="Arial, sans-serif" font-size="10" fill="#374151">• DB: 청록색</text>
  </g>
</svg>
